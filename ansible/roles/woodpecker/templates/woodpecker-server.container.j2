# {{ ansible_managed }}

[Unit]
Description=Woodpecker CI Server (Podman Quadlet)
After=network-online.target postgresql.service forgejo.service
Wants=network-online.target
Requires=postgresql.service

[Container]
ContainerName={{ woodpecker_server_container_name }}
Image={{ woodpecker_server_image }}
AutoUpdate=registry
PublishPort=127.0.0.1:{{ woodpecker_http_port }}:8000
PublishPort=127.0.0.1:{{ woodpecker_grpc_port }}:9000
Volume={{ woodpecker_data_dir }}:/var/lib/woodpecker:Z
EnvironmentFile={{ woodpecker_config_dir }}/woodpecker-server.env
Network={{ container_runtime_network_name | default('antarctica') }}

[Service]
Restart=always
TimeoutStartSec=300

[Install]
WantedBy=multi-user.target default.target
